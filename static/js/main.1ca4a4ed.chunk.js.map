{"version":3,"sources":["reducers/mqtt.tsx","components/Mqtt.tsx","components/Map.tsx","components/RouteSelector.tsx","components/InfoBar.tsx","components/Spinner/index.tsx","components/Icons/LeftArrow.tsx","components/Icons/RightArrow.tsx","App.tsx","serviceWorker.js","reducers/index.tsx","store.tsx","index.tsx"],"names":["subscribe","actionCreatorFactory","actionCreator","ALL_TOPIC","initialState","topic","Mqtt","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","mqttClient","onConnect","trackAll","connect","disConnect","unsubscribe","clearBusMarker","err","onError","onMessage","message","res","JSON","parse","toString","onReceive","VP","mqttConnect","on","nextProps","react_default","a","createElement","PureComponent","Map","busMarkers","infoWindow","infoWindowBusKey","map","maps","routePath","switchTopic","currentLocation","handleApiLoaded","event","addListener","closeOtherInfoWindow","regCurrentLocation","getCoords","data","lat","lng","long","getKey","concat","desi","dir","veh","isMarkerExist","key","undefined","handleMQTT","updateMarker","createMarker","idx","setMap","close","_this$getCoords","systemMarker","path","SymbolPath","FORWARD_CLOSED_ARROW","scale","rotation","hdg","strokeColor","strokeWeight","fillOpacity","fillColor","marker","Marker","position","icon","busKey","infoWindowContent","getInfoWindowContent","InfoWindow","content","open","delayString","dl","parseInt","toFixed","Math","abs","spd","_this$getCoords2","setPosition","setContent","center","CIRCLE","navigator","geolocation","watchPosition","_position$coords","coords","latitude","longitude","enableHighAccuracy","timeout","maximumAge","newProps","DEFAULT_TOPIC","geos","bounds","LatLngBounds","Polyline","geometry","geo","coord","lon","extend","geodesic","strokeOpacity","getCenter","fitBounds","_this2","style","height","width","lib_default","bootstrapURLKeys","defaultZoom","options","gestureHandling","zoomControl","yesIWantToUseGoogleMapApiInternals","onGoogleApiLoaded","_ref","components_Mqtt","DropdownIndicator","src","process","alt","CustomRouteOption","obj","innerProps","isDisabled","label","value","isFocused","assign","padding","display","background","alignItems","margin","marginBottom","longName","CustomDirectionOption","RouterSelector","state","selectedRoute","selectedDirection","routeOptions","directionOptions","handleRouteChange","ReactGA","category","action","shortName","patterns","push","headsign","setState","onSelect","handleDirectionChange","getPatterns","processedPatterns","forEach","pattern","trim","replace","toLowerCase","directionId","objectSpread","getOptions","routes","groupBy","keys","subArr","route","option","db","collection","get","then","querySnapshot","doc","_this$state","selectStyle","control","base","minHeight","border","boxShadow","&:hover","styles","menu","backgroundColor","top","zIndex","menuList","overflowY","menuPortal","marginTop","react_select_esm","onChange","isClearable","placeholder","components","Option","IndicatorSeparator","theme","borderRadius","colors","primary25","primary","React","InfoBar","react","color","fontWeight","marginRight","href","target","textDecoration","Spinner","className","LeftArrow","viewBox","d","fill","RightArrow","firebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","firestore","HELSINKI_GEO","App","panelClassName","window","innerWidth","mapClassName","togglePanel","onSelectHandler","type","fetchSingleLine","gtfsId","split","direction","line","_this3","getCurrentPosition","onClick","Icons_LeftArrow","Icons_RightArrow","RouteSelector","components_InfoBar","components_Map","Boolean","location","hostname","match","combineReducers","mqtt","arguments","length","isType","payload","store","createStore","rootReducer","__REDUX_DEVTOOLS_EXTENSION__","console","log","initialize","pageview","pathname","search","ReactDOM","render","es","src_App_0","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.1ca4a4ed.chunk.js","sourcesContent":["import { Action } from 'redux';\nimport actionCreatorFactory, { isType } from 'typescript-fsa';\n\nexport interface State {\n\ttopic: string;\n}\n\nconst actionCreator = actionCreatorFactory('mqtt');\nexport const subscribe = actionCreator<string>('SUBSCRIBE');\n\nexport const ALL_TOPIC = '/hfp/v1/journey/#';\nconst initialState = {\n\ttopic: ALL_TOPIC\n};\n\nexport default function(state: State = initialState, action: Action): State {\n\tif (isType(action, subscribe)) {\n\t\treturn { ...state, topic: action.payload };\n\t} else {\n\t\treturn state;\n\t}\n}\n","import React, { PureComponent } from 'react';\nimport { connect as mqttConnect, MqttClient, OnMessageCallback, OnErrorCallback } from 'mqtt';\nimport { MQTTResponse } from '../reducers';\nimport { ALL_TOPIC } from '../reducers/mqtt';\n\ntype Props = {\n\ttopic: string;\n\ttrackAll: boolean;\n\tonReceive: (data: MQTTResponse) => void;\n\tclearBusMarker: () => void;\n};\n\nclass Mqtt extends PureComponent<Props> {\n\tmqttClient: MqttClient;\n\tconstructor(props: Props) {\n\t\tsuper(props);\n\t\tthis.mqttClient = mqttConnect('mqtts://mqtt.hsl.fi:443');\n\t\tthis.mqttClient.on('connect', this.onConnect);\n\t\tthis.mqttClient.on('message', this.onMessage);\n\t\tthis.mqttClient.on('error', this.onError);\n\t}\n\n\tonConnect = () => {\n\t\tif (this.props.topic !== ALL_TOPIC || this.props.trackAll) {\n\t\t\tthis.connect(this.props.topic);\n\t\t}\n\t};\n\n\tdisConnect = (topic: string) => {\n\t\tthis.mqttClient.unsubscribe(topic, () => {\n\t\t\tthis.props.clearBusMarker();\n\t\t});\n\t};\n\n\tconnect = (topic: string) => {\n\t\tthis.mqttClient.subscribe(topic, err => {\n\t\t\tif (err) {\n\t\t\t}\n\t\t});\n\t};\n\n\tonError: OnErrorCallback = err => {};\n\n\tonMessage: OnMessageCallback = (topic, message) => {\n\t\tconst res = JSON.parse(message.toString());\n\t\tthis.props.onReceive(res.VP);\n\t};\n\n\tcomponentWillReceiveProps(nextProps: Props) {\n\t\tif (nextProps.topic !== this.props.topic) {\n\t\t\tthis.disConnect(this.props.topic);\n\t\t\tthis.connect(nextProps.topic);\n\t\t}\n\t}\n\n\trender() {\n\t\treturn <div />;\n\t}\n}\n\nexport default Mqtt;\n","import React, { PureComponent } from 'react';\nimport GoogleMapReact, { Coords } from 'google-map-react';\nimport Mqtt from './Mqtt';\nimport { GeoGroups, DEFAULT_TOPIC } from '../App';\n\nimport { MQTTResponse } from '../reducers';\n\ninterface Props {\n\tcenter: Coords;\n\ttopic: string;\n\tgeos?: GeoGroups;\n}\n\nclass Map extends PureComponent<Props> {\n\tbusMarkers: any = {};\n\tinfoWindow: any;\n\tinfoWindowBusKey: any;\n\tmap = null;\n\tmaps = null;\n\troutePath = null;\n\tswitchTopic = false;\n\tcurrentLocation = null;\n\n\thandleApiLoaded = (map: any, maps: any) => {\n\t\tthis.map = map;\n\t\tthis.maps = maps;\n\t\tmaps.event.addListener(map, 'click', () => {\n\t\t\tthis.closeOtherInfoWindow();\n\t\t});\n\t\tthis.regCurrentLocation();\n\t};\n\n\tgetCoords = (data: MQTTResponse) => {\n\t\treturn {\n\t\t\tlat: data.lat,\n\t\t\tlng: data.long\n\t\t};\n\t};\n\n\tgetKey = (data: MQTTResponse) => {\n\t\treturn `${data.desi}-${data.dir}-${data.veh}`;\n\t};\n\n\tisMarkerExist = (data: MQTTResponse) => {\n\t\tconst key = this.getKey(data);\n\t\treturn this.busMarkers[key] !== undefined;\n\t};\n\n\thandleMQTT = (data: MQTTResponse) => {\n\t\tif (this.map && this.maps) {\n\t\t\tif (this.isMarkerExist(data)) {\n\t\t\t\tthis.updateMarker(data);\n\t\t\t} else {\n\t\t\t\tthis.createMarker(data);\n\t\t\t}\n\t\t}\n\t};\n\n\tclearBusMarker = () => {\n\t\tif (this.switchTopic) {\n\t\t\tfor (let idx in this.busMarkers) {\n\t\t\t\tthis.busMarkers[idx].setMap(null);\n\t\t\t}\n\t\t\tthis.busMarkers = {};\n\t\t\tthis.switchTopic = false;\n\t\t}\n\t};\n\n\tcloseOtherInfoWindow = () => {\n\t\tif (this.infoWindow) this.infoWindow.close();\n\t};\n\n\tcreateMarker = (data: MQTTResponse) => {\n\t\tconst { lat, lng } = this.getCoords(data);\n\t\tif (lat && lng) {\n\t\t\t//const markerIcon = `${process.env.PUBLIC_URL}/marker.png`;\n\n\t\t\tconst systemMarker = {\n\t\t\t\tpath: (this.maps as any).SymbolPath.FORWARD_CLOSED_ARROW,\n\t\t\t\tscale: 3.5,\n\t\t\t\trotation: data.hdg,\n\t\t\t\tstrokeColor: '#e91e63',\n\t\t\t\tstrokeWeight: 2.5,\n\t\t\t\tfillOpacity: 1,\n\t\t\t\tfillColor: '#e91e63'\n\t\t\t};\n\n\t\t\t// var markerIcon = {\n\t\t\t// \tpath: 'M0 64 L32 42 L64 64 L32 0 Z',\n\t\t\t// \tfillColor: '#2196F3',\n\t\t\t// \tstrokeColor: 'white',\n\t\t\t// \tfillOpacity: 0.8,\n\t\t\t// \tscale: 0.8,\n\t\t\t// \trotation: data.hdg\n\t\t\t// };\n\t\t\tvar marker = new (this.maps as any).Marker({\n\t\t\t\tposition: { lat, lng },\n\t\t\t\tmap: this.map,\n\t\t\t\ticon: systemMarker\n\t\t\t});\n\t\t\tconst busKey = this.getKey(data);\n\t\t\tthis.busMarkers[busKey] = marker;\n\t\t\tmarker.addListener('click', () => {\n\t\t\t\tthis.closeOtherInfoWindow();\n\t\t\t\tconst infoWindowContent = this.getInfoWindowContent(data);\n\t\t\t\tthis.infoWindowBusKey = busKey;\n\t\t\t\tthis.infoWindow = new (this.maps as any).InfoWindow({\n\t\t\t\t\tcontent: infoWindowContent\n\t\t\t\t});\n\t\t\t\tthis.infoWindow.open(this.map, this.busMarkers[busKey]);\n\t\t\t});\n\t\t}\n\t};\n\n\tgetInfoWindowContent = (data: any) => {\n\t\tlet delayString;\n\t\tif (data.dl) {\n\t\t\tif (parseInt(data.dl) > 0) {\n\t\t\t\tif (data.dl < 100) {\n\t\t\t\t\tdelayString = `Early: ${data.dl}s`;\n\t\t\t\t} else {\n\t\t\t\t\tdelayString = `Early: ${(data.dl / 60).toFixed(2)}mins`;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (Math.abs(data.dl) < 100) {\n\t\t\t\t\tdelayString = `Delayed: ${Math.abs(data.dl)}s`;\n\t\t\t\t} else {\n\t\t\t\t\tdelayString = `Delayed: ${(Math.abs(data.dl) / 60).toFixed(2)}mins`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn `\n\t\t\t\t\t<ul style=\"\n\t\t\t\t\t\tlist-style-type: none;\n\t\t\t\t\t\tpadding: 0;\n\t\t\t\t\t\tmargin: 0;\n\t\t\t\t\t\tfont-size: 14px;\n\t\t\t\t\t\twidth: 200px;\n\t\t\t\t\t\">\n\t\t\t\t\t\t<li>No: ${data.desi}</li>\n\t\t\t\t\t\t<li>Speed: ${data.spd ? (data.spd * 3.6).toFixed(2) : 0} km/h</li>\n\t\t\t\t\t\t${delayString !== undefined ? `<li>${delayString}</li>` : ''}\n\t\t\t\t\t</ul>\n\t\t\t\t\t`;\n\t};\n\n\tupdateMarker = (data: MQTTResponse) => {\n\t\tconst { lat, lng } = this.getCoords(data);\n\t\tconst key = this.getKey(data);\n\t\tif (lat && lng) this.busMarkers[key].setPosition({ lat, lng });\n\t\tif (this.infoWindow && this.infoWindowBusKey === key) {\n\t\t\tthis.infoWindow.setContent(this.getInfoWindowContent(data));\n\t\t}\n\t};\n\n\tcomponentWillReceiveProps(nextProps: Props) {\n\t\tif (nextProps.topic !== this.props.topic) {\n\t\t\tthis.switchTopic = true;\n\t\t}\n\t}\n\n\tcomponentWillUpdate(newProps: any) {\n\t\tif (newProps.topic === DEFAULT_TOPIC) {\n\t\t\t(this.routePath as any).setMap(null);\n\t\t\treturn;\n\t\t}\n\t\tif (newProps.geos && this.maps && this.map) {\n\t\t\tif (this.routePath) {\n\t\t\t\t(this.routePath as any).setMap(null);\n\t\t\t}\n\t\t\tconst bounds = new (this.maps as any).LatLngBounds();\n\t\t\tthis.routePath = new (this.maps as any).Polyline({\n\t\t\t\tpath: newProps.geos.geometry.map((geo: any) => {\n\t\t\t\t\tconst coord = {\n\t\t\t\t\t\tlat: geo.lat,\n\t\t\t\t\t\tlng: geo.lon\n\t\t\t\t\t};\n\t\t\t\t\tbounds.extend(coord);\n\t\t\t\t\treturn coord;\n\t\t\t\t}),\n\t\t\t\tgeodesic: true,\n\t\t\t\tstrokeColor: '#2196F3',\n\t\t\t\tstrokeOpacity: 1.0,\n\t\t\t\tstrokeWeight: 3\n\t\t\t});\n\n\t\t\t(this.routePath as any).setMap(this.map);\n\t\t\tbounds.getCenter();\n\t\t\t(this.map as any).fitBounds(bounds);\n\t\t}\n\t}\n\n\tregCurrentLocation = () => {\n\t\tif (this.currentLocation == null) {\n\t\t\tthis.currentLocation = new (this.maps as any).Marker({\n\t\t\t\tposition: { lat: this.props.center.lat, lng: this.props.center.lng },\n\t\t\t\tmap: this.map,\n\t\t\t\ticon: {\n\t\t\t\t\tpath: (this.maps as any).SymbolPath.CIRCLE,\n\t\t\t\t\tscale: 7,\n\t\t\t\t\tstrokeColor: '#C8D6EC',\n\t\t\t\t\tstrokeWeight: 2.5,\n\t\t\t\t\tfillOpacity: 1,\n\t\t\t\t\tfillColor: '#4285F4'\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tnavigator.geolocation.watchPosition(\n\t\t\tposition => {\n\t\t\t\tconst { latitude, longitude } = position.coords;\n\n\t\t\t\t(this.currentLocation as any).setPosition({\n\t\t\t\t\tlat: latitude,\n\t\t\t\t\tlng: longitude\n\t\t\t\t});\n\t\t\t},\n\t\t\t() => {},\n\t\t\t{\n\t\t\t\tenableHighAccuracy: false,\n\t\t\t\ttimeout: 5000,\n\t\t\t\tmaximumAge: 0\n\t\t\t}\n\t\t);\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<div style={{ height: '100vh', width: '100%' }}>\n\t\t\t\t<GoogleMapReact\n\t\t\t\t\tbootstrapURLKeys={{ key: 'AIzaSyBXy6VGyQlLMU9cFIgPh3AzCva_zXY2YJY' }}\n\t\t\t\t\tcenter={this.props.center}\n\t\t\t\t\tdefaultZoom={15}\n\t\t\t\t\toptions={{\n\t\t\t\t\t\tgestureHandling: 'greedy',\n\t\t\t\t\t\tzoomControl: false\n\t\t\t\t\t}}\n\t\t\t\t\tyesIWantToUseGoogleMapApiInternals\n\t\t\t\t\tonGoogleApiLoaded={({ map, maps }) => this.handleApiLoaded(map, maps)}\n\t\t\t\t/>\n\t\t\t\t<Mqtt\n\t\t\t\t\ttrackAll={true}\n\t\t\t\t\tonReceive={this.handleMQTT}\n\t\t\t\t\tclearBusMarker={this.clearBusMarker}\n\t\t\t\t\ttopic={this.props.topic}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Map;\n","//@ts-ignore\nimport React from 'react';\nimport Select from 'react-select';\nimport groupBy from 'lodash.groupby';\nimport ReactGA from 'react-ga';\n\ninterface Props {\n\tclassName: string;\n\troutes: any[];\n\tdb: any;\n\tonSelect: (type: string, option: any) => void;\n}\n\ninterface Pattern {\n\tdirectionId: number;\n\theadsign: string;\n}\n\nconst DropdownIndicator = () => {\n\treturn (\n\t\t<div\n\t\t\tstyle={{\n\t\t\t\twidth: '30px'\n\t\t\t}}\n\t\t>\n\t\t\t<img src={`${process.env.PUBLIC_URL}/arrow_down.svg`} alt=\"\" />\n\t\t</div>\n\t);\n};\n\nconst CustomRouteOption = (obj: any) => {\n\tconst { innerProps, isDisabled, label, value, isFocused } = obj;\n\treturn !isDisabled ? (\n\t\t<div\n\t\t\t{...innerProps}\n\t\t\tstyle={{\n\t\t\t\tpadding: '10px',\n\t\t\t\tdisplay: 'flex',\n\t\t\t\tbackground: isFocused ? '#e3e3e3' : '',\n\t\t\t\talignItems: 'center'\n\t\t\t}}\n\t\t>\n\t\t\t<div>\n\t\t\t\t<img\n\t\t\t\t\tsrc={`${process.env.PUBLIC_URL}/bus.svg`}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\twidth: '30px',\n\t\t\t\t\t\tpadding: '0 10px 0 0'\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<h4\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tmargin: 0,\n\t\t\t\t\t\tmarginBottom: '5px'\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{label}\n\t\t\t\t</h4>\n\t\t\t\t<p\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tmargin: 0\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{value.longName}\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t</div>\n\t) : null;\n};\n\nconst CustomDirectionOption = (obj: any) => {\n\tconst { innerProps, label, isFocused } = obj;\n\treturn (\n\t\t<div\n\t\t\t{...innerProps}\n\t\t\tstyle={{\n\t\t\t\tpadding: '10px',\n\t\t\t\tbackground: isFocused ? '#e3e3e3' : ''\n\t\t\t}}\n\t\t>\n\t\t\t<h4\n\t\t\t\tstyle={{\n\t\t\t\t\tmargin: 0,\n\t\t\t\t\tmarginBottom: '5px'\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{label}\n\t\t\t</h4>\n\t\t</div>\n\t);\n};\n\nclass RouterSelector extends React.PureComponent<Props> {\n\tstate = {\n\t\tselectedRoute: null,\n\t\tselectedDirection: null,\n\t\trouteOptions: [],\n\t\tdirectionOptions: []\n\t};\n\n\thandleRouteChange = (selectedRoute: any) => {\n\t\tif (selectedRoute) {\n\t\t\tReactGA.event({\n\t\t\t\tcategory: 'Route',\n\t\t\t\taction: selectedRoute.value.shortName\n\t\t\t});\n\t\t\tconst directionOptions = [];\n\t\t\tconst patterns = selectedRoute.value.patterns;\n\t\t\tfor (let key in patterns) {\n\t\t\t\tdirectionOptions.push({\n\t\t\t\t\tlabel: patterns[key].headsign,\n\t\t\t\t\tvalue: patterns[key]\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.setState({\n\t\t\t\tselectedRoute,\n\t\t\t\tselectedDirection: null,\n\t\t\t\tdirectionOptions\n\t\t\t});\n\t\t} else {\n\t\t\tReactGA.event({\n\t\t\t\tcategory: 'Route',\n\t\t\t\taction: 'All'\n\t\t\t});\n\t\t\tthis.setState({\n\t\t\t\tselectedRoute: null,\n\t\t\t\tselectedDirection: null,\n\t\t\t\tdirectionOptions: []\n\t\t\t});\n\t\t}\n\t\tthis.props.onSelect('route', selectedRoute);\n\t};\n\n\thandleDirectionChange = (selectedDirection: any) => {\n\t\tif (selectedDirection) {\n\t\t\tthis.setState({ selectedDirection });\n\t\t\tthis.props.onSelect('direction', selectedDirection);\n\t\t\tReactGA.event({\n\t\t\t\tcategory: 'Route',\n\t\t\t\taction: (this.state.selectedRoute as any).value.shortName,\n\t\t\t\tvalue: selectedDirection\n\t\t\t});\n\t\t} else {\n\t\t\tthis.setState({ selectedDirection: null });\n\t\t\tReactGA.event({\n\t\t\t\tcategory: 'Route',\n\t\t\t\taction: 'clear direction'\n\t\t\t});\n\t\t}\n\t\tthis.props.onSelect('direction', selectedDirection);\n\t};\n\n\tgetPatterns = (patterns: Pattern[]) => {\n\t\tconst processedPatterns: any = {};\n\t\tpatterns.forEach((pattern: Pattern, idx: number) => {\n\t\t\tconst headsign = pattern.headsign\n\t\t\t\t.trim()\n\t\t\t\t.replace(/ /g, '')\n\t\t\t\t.toLowerCase();\n\t\t\tif (\n\t\t\t\tprocessedPatterns[headsign] === undefined ||\n\t\t\t\tprocessedPatterns[headsign].directionId !== pattern.directionId\n\t\t\t) {\n\t\t\t\tprocessedPatterns[headsign] = { ...pattern, idx };\n\t\t\t}\n\t\t});\n\t\treturn processedPatterns;\n\t};\n\n\tgetOptions = (routes: any) => {\n\t\tconst obj = groupBy(routes, 'mode');\n\t\tconst options: any = [];\n\t\tObject.keys(obj).forEach(key => {\n\t\t\tconst subArr: any = [];\n\t\t\tobj[key].forEach(route => {\n\t\t\t\troute.patterns = this.getPatterns(route.patterns);\n\t\t\t\tconst option = {\n\t\t\t\t\tvalue: route,\n\t\t\t\t\tlabel: `${route.shortName}`\n\t\t\t\t};\n\t\t\t\tsubArr.push(option);\n\t\t\t});\n\n\t\t\toptions.push({\n\t\t\t\tlabel: key,\n\t\t\t\toptions: subArr\n\t\t\t});\n\t\t});\n\n\t\tthis.setState({\n\t\t\trouteOptions: options\n\t\t});\n\t};\n\n\tcomponentDidMount() {\n\t\tthis.props.db\n\t\t\t.collection('routes')\n\t\t\t.get()\n\t\t\t.then((querySnapshot: any) => {\n\t\t\t\tconst routes: any = [];\n\t\t\t\tquerySnapshot.forEach((doc: any) => {\n\t\t\t\t\troutes.push(doc.data());\n\t\t\t\t});\n\t\t\t\tthis.getOptions(routes);\n\t\t\t});\n\t}\n\n\trender() {\n\t\tconst { selectedRoute, selectedDirection, routeOptions, directionOptions } = this.state;\n\t\tconst selectStyle = {\n\t\t\tcontrol: (base: any, state: any) => ({\n\t\t\t\t...base,\n\t\t\t\tminHeight: '48px !important',\n\t\t\t\tborder: '0 !important',\n\t\t\t\tboxShadow: '0px 2px 1px rgba(0,0,0, .2) !important',\n\t\t\t\t'&:hover': {\n\t\t\t\t\tborder: '0 !important'\n\t\t\t\t}\n\t\t\t}),\n\t\t\toption: (styles: any) => {\n\t\t\t\treturn {\n\t\t\t\t\t...styles\n\t\t\t\t};\n\t\t\t},\n\t\t\tmenu: (styles: any) => {\n\t\t\t\treturn {\n\t\t\t\t\t...styles,\n\t\t\t\t\tbackgroundColor: 'white',\n\t\t\t\t\tboxShadow: '1px 2px 6px #888888',\n\t\t\t\t\ttop: `calc(100% + 1px)`,\n\t\t\t\t\tzIndex: 2\n\t\t\t\t};\n\t\t\t},\n\t\t\tmenuList: (styles: any) => {\n\t\t\t\treturn {\n\t\t\t\t\t...styles,\n\t\t\t\t\toverflowY: 'auto'\n\t\t\t\t};\n\t\t\t},\n\t\t\tmenuPortal: (styles: any) => {\n\t\t\t\treturn {\n\t\t\t\t\t...styles,\n\t\t\t\t\tmarginTop: '10px'\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tstyle={{\n\t\t\t\t\twidth: '100%',\n\t\t\t\t\tmargin: '0 auto',\n\t\t\t\t\tmarginTop: '30px'\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Select\n\t\t\t\t\tvalue={selectedRoute}\n\t\t\t\t\toptions={routeOptions}\n\t\t\t\t\tonChange={this.handleRouteChange}\n\t\t\t\t\tisClearable={true}\n\t\t\t\t\tplaceholder={'Enter route number... (E.g.: 550)'}\n\t\t\t\t\tstyles={selectStyle}\n\t\t\t\t\tcomponents={{\n\t\t\t\t\t\tDropdownIndicator,\n\t\t\t\t\t\tOption: CustomRouteOption,\n\t\t\t\t\t\tIndicatorSeparator: () => null\n\t\t\t\t\t}}\n\t\t\t\t\ttheme={theme => ({\n\t\t\t\t\t\t...theme,\n\t\t\t\t\t\tborderRadius: 0,\n\t\t\t\t\t\tborder: 0,\n\t\t\t\t\t\tcolors: {\n\t\t\t\t\t\t\t...theme.colors,\n\t\t\t\t\t\t\tprimary25: 'lightGray',\n\t\t\t\t\t\t\tprimary: 'Gainsboro'\n\t\t\t\t\t\t}\n\t\t\t\t\t})}\n\t\t\t\t/>\n\n\t\t\t\t<br />\n\t\t\t\t{this.state.selectedRoute && (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\tvalue={selectedDirection}\n\t\t\t\t\t\t\toptions={directionOptions}\n\t\t\t\t\t\t\tonChange={this.handleDirectionChange}\n\t\t\t\t\t\t\tplaceholder={'Choose Destination...'}\n\t\t\t\t\t\t\tisClearable={true}\n\t\t\t\t\t\t\tstyles={selectStyle}\n\t\t\t\t\t\t\tcomponents={{\n\t\t\t\t\t\t\t\tDropdownIndicator,\n\t\t\t\t\t\t\t\tOption: CustomDirectionOption,\n\t\t\t\t\t\t\t\tIndicatorSeparator: () => {\n\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ttheme={theme => ({\n\t\t\t\t\t\t\t\t...theme,\n\t\t\t\t\t\t\t\tborderRadius: 0,\n\t\t\t\t\t\t\t\tborder: 0,\n\t\t\t\t\t\t\t\tcolors: {\n\t\t\t\t\t\t\t\t\t...theme.colors,\n\t\t\t\t\t\t\t\t\tprimary25: 'lightGray',\n\t\t\t\t\t\t\t\t\tprimary: 'Gainsboro'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default RouterSelector;\n","import * as React from 'react';\n\nexport interface InfoBarProps {}\n\nconst InfoBar: React.SFC<InfoBarProps> = () => {\n\treturn (\n\t\t<div\n\t\t\tstyle={{\n\t\t\t\twidth: '100%',\n\t\t\t\tmargin: '0 auto',\n\t\t\t\tcolor: 'white',\n\t\t\t\ttop: '300px'\n\t\t\t}}\n\t\t>\n\t\t\t<h2>Helbus - Helsinki Bus Tracker</h2>\n\t\t\t<p>Track HSL bus/tram/train in real time.</p>\n\t\t\t<hr\n\t\t\t\tstyle={{\n\t\t\t\t\tbackground: '#f3f3f3',\n\t\t\t\t\theight: '1px',\n\t\t\t\t\tborder: '0px'\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<p>\n\t\t\t\t<span\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tfontWeight: 'bold',\n\t\t\t\t\t\tmarginRight: '5px'\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tAuthors:\n\t\t\t\t</span>\n\t\t\t\t<a\n\t\t\t\t\thref=\"http://loveyoung.me\"\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tcolor: 'white',\n\t\t\t\t\t\ttextDecoration: 'underline'\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tLi@ng\n\t\t\t\t</a>{' '}\n\t\t\t\t&amp; Hengda Xiao\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\t<span\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tfontWeight: 'bold',\n\t\t\t\t\t\tmarginRight: '5px'\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tContact:\n\t\t\t\t</span>\n\t\t\t\t<a\n\t\t\t\t\thref=\"mailto:feedback@helbus.live\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tcolor: 'white'\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tfeedback@helbus.live\n\t\t\t\t</a>\n\t\t\t</p>\n\t\t</div>\n\t);\n};\n\nexport default InfoBar;\n","import './spinner.css';\nimport React from 'react';\n\nexport default () => {\n\treturn (\n\t\t<div className=\"spinner\">\n\t\t\t<div className=\"bounce1\" />\n\t\t\t<div className=\"bounce2\" />\n\t\t\t<div className=\"bounce3\" />\n\t\t</div>\n\t);\n};\n","import React from 'react';\n\nconst LeftArrow = (props: any) => (\n\t<svg viewBox=\"0 0 24 24\" {...props}>\n\t\t<path d=\"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z\" fill=\"currentColor\" />\n\t\t<path d=\"M0 0h24v24H0z\" fill=\"none\" />\n\t</svg>\n);\n\nexport default LeftArrow;\n","import React from 'react';\n\nconst RightArrow = (props: any) => (\n\t<svg viewBox=\"0 0 24 24\" {...props}>\n\t\t<path d=\"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z\" fill=\"currentColor\" />\n\t\t<path d=\"M0 0h24v24H0z\" fill=\"none\" />\n\t</svg>\n);\n\nexport default RightArrow;\n","import React, { PureComponent } from 'react';\nimport Map from './components/Map';\nimport RouterSelector from './components/RouteSelector';\nimport InfoBar from './components/InfoBar';\nimport './App.css';\nimport Spinner from './components/Spinner';\nimport firebase from 'firebase/app';\nimport 'firebase/database';\nimport 'firebase/firestore';\nimport LeftArrowIcon from './components/Icons/LeftArrow';\nimport RightArrowIcon from './components/Icons/RightArrow';\n\nconst firebaseConfig = {\n\tapiKey: 'AIzaSyDQCOGADe5bDTrF-6qs2Bcm4I9XYHm_oUY',\n\tauthDomain: 'hsltrack.firebaseapp.com',\n\tdatabaseURL: 'https://hsltrack.firebaseio.com',\n\tprojectId: 'hsltrack',\n\tstorageBucket: 'hsltrack.appspot.com',\n\tmessagingSenderId: '941183968719'\n};\n\nfirebase.initializeApp(firebaseConfig);\n// Initialize Cloud Firestore through Firebase\nfirebase.firestore();\n\nconst db = firebase.firestore();\n\nconst HELSINKI_GEO = {\n\tlat: 60.1699,\n\tlng: 24.9384\n};\n\nexport const DEFAULT_TOPIC = '/hfp/v1/journey/#';\n\nexport interface Geo {\n\tlat: number;\n\tlon: number;\n}\n\nexport interface GeoGroups {\n\tgeometry: Geo[];\n}\n\nclass App extends PureComponent {\n\tstate = {\n\t\tcenter: null,\n\t\tpanelClassName: window.innerWidth <= 600 ? 'panel hide' : 'panel',\n\t\tmapClassName: window.innerWidth <= 600 ? 'map-wrapper full-width' : 'map-wrapper',\n\t\troutes: [],\n\t\tselectedRoute: null,\n\t\tselectedDirection: null,\n\t\tgeos: []\n\t};\n\tfetchSingleLine(line: string) {\n\t\tdb.collection('routes_geos')\n\t\t\t.doc(line)\n\t\t\t.get()\n\t\t\t.then(doc => {\n\t\t\t\tconst geos = (doc.data() as any).patterns as GeoGroups;\n\n\t\t\t\tthis.setState({\n\t\t\t\t\tgeos\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tcomponentDidMount() {\n\t\tif (navigator.geolocation) {\n\t\t\tnavigator.geolocation.getCurrentPosition(\n\t\t\t\tposition => {\n\t\t\t\t\tconst { latitude, longitude } = position.coords;\n\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tcenter: {\n\t\t\t\t\t\t\tlat: latitude,\n\t\t\t\t\t\t\tlng: longitude\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tcenter: HELSINKI_GEO\n\t\t\t\t\t});\n\t\t\t\t},{\n\t\t\t\t\ttimeout: 5000\n\t\t\t\t}\n\t\t\t);\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\tcenter: HELSINKI_GEO\n\t\t\t});\n\t\t}\n\t}\n\n\ttogglePanel = () => {\n\t\tthis.setState({\n\t\t\tpanelClassName: this.state.panelClassName === 'panel' ? 'panel hide' : 'panel',\n\t\t\tmapClassName: this.state.mapClassName === 'map-wrapper' ? 'map-wrapper full-width' : 'map-wrapper'\n\t\t});\n\t};\n\n\tonSelectHandler = (type: string, option: any) => {\n\t\tif (type === 'route') {\n\t\t\tif (option) {\n\t\t\t\tthis.fetchSingleLine(option.value.gtfsId);\n\t\t\t\tconst route = option.value.gtfsId.split(':')[1];\n\t\t\t\tthis.setState({\n\t\t\t\t\tselectedRoute: route\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst obj = { selectedRoute: null };\n\t\t\t\tif (window.innerWidth <= 600) {\n\t\t\t\t\t(obj as any).panelClassName = 'panel hide';\n\t\t\t\t}\n\t\t\t\tthis.setState(obj);\n\t\t\t}\n\t\t} else if (type === 'direction') {\n\t\t\tif (option) {\n\t\t\t\tconst direction = parseInt(option.value.directionId);\n\t\t\t\tthis.setState({\n\t\t\t\t\tselectedDirection: direction\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.setState({\n\t\t\t\t\tselectedDirection: null\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\trender() {\n\t\tlet topic = DEFAULT_TOPIC;\n\t\tif (this.state.selectedRoute !== null) {\n\t\t\ttopic = `/hfp/v1/journey/+/+/+/+/${this.state.selectedRoute}/#`;\n\t\t}\n\n\t\tif (this.state.selectedDirection !== null) {\n\t\t\ttopic = `/hfp/v1/journey/+/+/+/+/${this.state.selectedRoute}/${this.state.selectedDirection! + 1}/#`;\n\t\t}\n\n\t\tif (this.state.center) {\n\t\t\treturn (\n\t\t\t\t<div className=\"app\">\n\t\t\t\t\t<div className={this.state.panelClassName}>\n\t\t\t\t\t\t<div className=\"toggle-btn\" onClick={this.togglePanel}>\n\t\t\t\t\t\t\t{this.state.panelClassName === 'panel' ? (\n\t\t\t\t\t\t\t\t<LeftArrowIcon\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tmarginTop: '10px'\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<RightArrowIcon\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tmarginTop: '10px'\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<RouterSelector\n\t\t\t\t\t\t\tonSelect={this.onSelectHandler}\n\t\t\t\t\t\t\tdb={db}\n\t\t\t\t\t\t\troutes={this.state.routes}\n\t\t\t\t\t\t\tclassName=\"router-selector\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button className=\"btn mobile-search\" onClick={this.togglePanel}>\n\t\t\t\t\t\t\tSearch\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<InfoBar />\n\t\t\t\t\t\t<div className=\"mobile-app-download-wrapper\">\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\thref=\"https://itunes.apple.com/fi/app/helbus/id1458224268\"\n\t\t\t\t\t\t\t\tclassName=\"mobile-app-download-icon\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<img src={`${process.env.PUBLIC_URL}/Apple_Store_Icon.png`} alt=\"\" />\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\thref=\"https://play.google.com/store/apps/details?id=live.hsltrack\"\n\t\t\t\t\t\t\t\tclassName=\"mobile-app-download-icon\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<img src={`${process.env.PUBLIC_URL}/Google_Play_Icon.png`} alt=\"\" />\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={this.state.mapClassName}>\n\t\t\t\t\t\t{this.state.selectedDirection ? (\n\t\t\t\t\t\t\t<Map center={this.state.center!} topic={topic} geos={this.state.geos[this.state.selectedDirection!]} />\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<Map center={this.state.center!} topic={topic} geos={this.state.geos[0]} />\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"clear\" />\n\t\t\t\t</div>\n\t\t\t);\n\t\t} else {\n\t\t\treturn <Spinner />;\n\t\t}\n\t}\n}\n\nexport default App;\n","/* tslint:disable */\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n\twindow.location.hostname === 'localhost' ||\n\t\t// [::1] is the IPv6 localhost address.\n\t\twindow.location.hostname === '[::1]' ||\n\t\t// 127.0.0.1/8 is considered localhost for IPv4.\n\t\twindow.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport function register(config) {\n\tif (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n\t\t// The URL constructor is available in all browsers that support SW.\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n\t\tif (publicUrl.origin !== window.location.origin) {\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\n\t\t\t// serve assets; see https://github.com/facebook/create-react-app/issues/2374\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener('load', () => {\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n\t\t\tif (isLocalhost) {\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\n\t\t\t\tcheckValidServiceWorker(swUrl, config);\n\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\n\t\t\t\t// service worker/PWA documentation.\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t'This web app is being served cache-first by a service ' +\n\t\t\t\t\t\t\t'worker. To learn more, visit http://bit.ly/CRA-PWA'\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Is not localhost. Just register service worker\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction registerValidSW(swUrl, config) {\n\tnavigator.serviceWorker\n\t\t.register(swUrl)\n\t\t.then(registration => {\n\t\t\tregistration.onupdatefound = () => {\n\t\t\t\tconst installingWorker = registration.installing;\n\t\t\t\tif (installingWorker == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tinstallingWorker.onstatechange = () => {\n\t\t\t\t\tif (installingWorker.state === 'installed') {\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\n\t\t\t\t\t\t\t// At this point, the updated precached content has been fetched,\n\t\t\t\t\t\t\t// but the previous service worker will still serve the older\n\t\t\t\t\t\t\t// content until all client tabs are closed.\n\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t'New content is available and will be used when all ' +\n\t\t\t\t\t\t\t\t\t'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// At this point, everything has been precached.\n\t\t\t\t\t\t\t// It's the perfect time to display a\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\n\t\t\t\t\t\t\tconsole.log('Content is cached for offline use.');\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t})\n\t\t.catch(error => {\n\t\t\tconsole.error('Error during service worker registration:', error);\n\t\t});\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n\t// Check if the service worker can be found. If it can't reload the page.\n\tfetch(swUrl)\n\t\t.then(response => {\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\n\t\t\tconst contentType = response.headers.get('content-type');\n\t\t\tif (response.status === 404 || (contentType != null && contentType.indexOf('javascript') === -1)) {\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\n\t\t\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\t\t\tregistration.unregister().then(() => {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Service worker found. Proceed as normal.\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tconsole.log('No internet connection found. App is running in offline mode.');\n\t\t});\n}\n\nexport function unregister() {\n\tif ('serviceWorker' in navigator) {\n\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\tregistration.unregister();\n\t\t});\n\t}\n}\n","import { combineReducers } from 'redux';\nimport mqtt, { State as MqttState } from './mqtt';\n\nexport interface MQTTResponse {\n\tdesi?: string; // Route number visible to passengers.\n\tdir?: string; // Route direction of the trip. After type conversion matches direction_id in GTFS and the topic. Either \"1\" or \"2\"\n\toper?: number; // Unique ID of the operator running the trip. The unique ID does not have prefix zeroes here.\n\n\t// Vehicle number that can be seen painted on the side of the vehicle, often next to the front door.\n\t// Different operators may use overlapping vehicle numbers.\n\t// Matches vehicle_number in the topic except without the prefix zeroes.\n\tveh?: number;\n\n\ttst?: string; // UTC timestamp from the vehicle in ISO 8601 format as output by date --utc \"+%Y-%m-%dT%H:%M:%SZ\"\n\ttsi?: number; // Unix time in seconds, matching tst.\n\tspd?: number; // Speed of the vehicle, in meters per second (m/s).\n\thdg?: number; // Heading of the vehicle, in degrees (‚Å∞) starting clockwise from geographic north. Valid values are on the closed interval [0, 360].\n\tlat?: number; // WGS 84 latitude in degrees. null if there is no GPS fix.\n\tlong?: number; // WGS 84 longitude in degrees. null if there is no GPS fix.\n\tacc?: number; // Acceleration (m/s^2), calculated from the speed on this and the previous message. Negative values indicate that the speed of the vehicle is decreasing.\n\tdl?: number; // Offset from the scheduled timetable in seconds (s). Negative values indicate lagging behind the schedule, positive values running ahead of schedule.\n\todo?: number; // The odometer reading in meters (m) since the start of the trip. Currently the values not very reliable.\n\tdrst?: number; // Door status. 0 if all the doors are closed, 1 if any of the doors are open.\n\t/**\n\t * Operating day of the trip.\n\t * The exact time when an operating day ends depends on the route.\n\t * For most routes, the operating day ends at 4:30 AM on the next day.\n\t * In that case, for example, the final moment of the operating day \"2018-04-05\" would be at 2018-04-06T04:30 local time.\n\t */\n\today?: string;\n\n\tjrn?: number; // Internal journey descriptor, not meant to be useful for external use.\n\tline?: number; // Internal line descriptor, not meant to be useful for external use.\n\n\t/**\n\t *Scheduled start time of the trip.\n\t i.e. the scheduled departure time from the first stop of the trip.\n\t The format follows %H:%M in 24-hour local time, not the 30-hour overlapping operating days present in GTFS.\n\t Matches start_time in the topic.\n\t */\n\tstart?: string;\n}\n\nexport interface RootState {\n\tmqtt: MqttState;\n}\n\nexport default combineReducers<RootState>({\n\tmqtt\n});\n","import { createStore } from 'redux';\nimport rootReducer from './reducers';\nconst store = createStore(\n\trootReducer,\n\t(window as any).__REDUX_DEVTOOLS_EXTENSION__ && (window as any).__REDUX_DEVTOOLS_EXTENSION__()\n);\n\nexport default store;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker.js';\nimport store from './store';\nimport ReactGA from 'react-ga';\nimport { Provider } from 'react-redux';\n\nif (process.env.NODE_ENV !== 'development') {\n\tconsole.log = () => {};\n}\nReactGA.initialize('UA-72512078-3');\nReactGA.pageview(window.location.pathname + window.location.search);\n\nReactDOM.render(\n\t<Provider store={store}>\n\t\t<App />\n\t</Provider>,\n\tdocument.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}